<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>AirPods</title>
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="stylesheet" type="text/css" href="static/css/style.css"/>
    <link rel="stylesheet" type="text/css" href="static/css/main.css"/>
    <link rel="stylesheet" type="text/css" href="static/css/media.css"/>
    <link rel="stylesheet" href="static/layui/css/layui.css" media="all">
</head>

<body>
<!-- 菜单导航部分 -->
<div class="nav">
    <a href="index.html" class="logo"></a>
    <a href="javascript:void(0)" class="text">Repair order</a>
    <a href="questionnaire.html" class="text">Questionnaire</a>
    <a href="faq.html" class="text">FAQ</a>
    <input hidden="hidden" type="checkbox" name="choose" id="choose" value=""/>
    <label for="choose" class="toggle-btn">
        <span class="line"></span>
        <span class="line"></span>
    </label>
    <!-- 菜单导航中，隐藏的变成移动端后才显示的菜单 -->
    <div class="nav-content">
        <div class="nav-page">
            <div class="search-input">
                <div class="icon" id="search-btn"></div>
                <input type="text" name="searchName" id="searchName" placeholder="search name"/>
                <span class="search-close">取消</span>
            </div>
            <hr/>
            <div class="nav-list search-list">
                <h4 style="margin-top: 12px;font-size: 18px;">Quick Links</h4>
                <a href="javascript:void(0)" class="nav-text search-result">No Found</a>
                <a style="border-bottom: 1px solid #333;" href="javascript:void(0)" class="nav-text search-faq-result">No Found</a>
            </div>
            <div class="nav-list nav-box">
                <a href="index.html" class="nav-text">Home</a>
                <a href="javascript:void(0)" class="nav-text">Repair order</a>
                <a href="questionnaire.html" class="nav-text">Questionnaire</a>
                <a href="faq.html" class="nav-text">FAQ</a>
            </div>
        </div>
    </div>
</div>

<section class="section section-form" id="maintain-page1">
    <div class="section-content maintain-page1">
        <h4>Shipping</h4>
        <p>Where should we send your replacement product?</p>
        <form class="layui-form" action="">
            <div class="layui-form-item mob-box">
                <div class="layui-inline layui-inline-active">
                    <label class="layui-form-label">First Name</label>
                    <div class="layui-input-inline">
                        <input type="text" name="first_name" lay-verify="required" autocomplete="off"
                               class="layui-input">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">Last Name</label>
                    <div class="layui-input-inline">
                        <input type="text" name="last_name" lay-verify="required" autocomplete="off"
                               class="layui-input">
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">Street Address</label>
                <div class="layui-input-inline">
                    <input type="text" name="street_address" lay-verify="required" autocomplete="off"
                           placeholder=""
                           class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">Apt, Suite, Bldg</label>
                <div class="layui-input-inline">
                    <input type="text" name="spt" lay-verify="required" placeholder="" autocomplete="off"
                           class="layui-input">
                </div>
            </div>
            <div class="layui-form-item mob-box">
                <div class="layui-inline layui-inline-active">
                    <label class="layui-form-label">State</label>
                    <div class="layui-input-inline">
                        <select name="state" id="state" lay-filter="state" lay-verify="required"></select>
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">City</label>
                    <div class="layui-input-inline">
                        <select name="city" id="city" lay-filter="city" lay-verify="required"></select>
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">Zip code</label>
                <div class="layui-input-inline">
                    <input type="text" name="zip" lay-verify="zipCode" autocomplete="off" placeholder=""
                           class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">Country or Region</label>
                <div class="layui-input-inline">
                    <select name="region" disabled lay-verify="region">
                        <option value=""></option>
                        <option value="United States" selected="selected">United States</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">Email Address</label>
                <div class="layui-input-inline">
                    <input type="text" name="email" lay-verify="email" autocomplete="off" placeholder=""
                           class="layui-input">
                </div>
                <div class="layui-form-mid layui-word-aux">We send repair status</div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">Phone Number</label>
                <div class="layui-input-inline">
                    <input type="text" name="phone" lay-verify="phone" placeholder="" autocomplete="off"
                           class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <div class=" button-wrapper">
                    <button type="submit" class="serial-form-btn" lay-submit="" lay-filter="serial-btn1">Continue
                    </button>
                </div>
            </div>
        </form>
    </div>
</section>

<section class="section section-form" id="maintain-page2">
    <div class="section-content maintain-page2 maintain-bill">
        <h4>Here’s your estimated quote:</h4>
        <ul class="quote-list quote-list-top"></ul>
        <ul class="quote-list">
            <li>
                <span>Shipping</span><span class="shippingNum">$0.00</span>
            </li>
            <li>
                <span>Tax</span><span class="taxNum">$0.00</span>
            </li>
        </ul>
        <div class="quote-total">
            <span class="label">Total</span><span class="totalNum">$0.00</span>
        </div>
        <div class="quote-billing">
            <h4>Billing</h4>
            <p>Credit Card Information</p>
        </div>
        <form class="layui-form" action="">
            <div class="layui-form-item">
                <label class="layui-form-label">Name on Card</label>
                <div class="layui-input-inline">
                    <input type="text" name="card" lay-verify="card" autocomplete="off" placeholder=""
                           class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">Credit Card Number</label>
                <div class="layui-input-inline">
                    <input type="text" name="creditNumber" lay-verify="creditNumber" autocomplete="off" placeholder=""
                           class="layui-input">
                </div>
            </div>
            <div class="layui-form-item mob-box">
                <div class="layui-inline layui-inline-active">
                    <label class="layui-form-label">CVV</label>
                    <div class="layui-input-inline">
                        <input type="text" name="cvv" lay-verify="cvv" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">Expiration, Date</label>
                    <div class="layui-input-inline">
                        <input type="text" name="expiration" id="expiration" lay-verify="expiration"
                               placeholder="yyyy-MM-dd" autocomplete="off" class="layui-input">
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label layui-active-label" style="width: 102px;">Billing Address</label>
                <div class="layui-input-inline">
                    <input type="checkbox" name="is_send" id="is_send" lay-filter="is_send"  title="Same as Shipping" lay-skin="primary">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">Street Address</label>
                <div class="layui-input-inline">
                    <input type="text" name="billing_street" id="billing_street" lay-verify="required" autocomplete="off"
                           placeholder=""
                           class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">Apt, Suite, Bldg</label>
                <div class="layui-input-inline">
                    <input type="text" name="billing_apt" id="billing_apt" lay-verify="required" autocomplete="off" placeholder=""
                           class="layui-input">
                </div>
            </div>
            <div class="layui-form-item mob-box">
                <div class="layui-inline  layui-inline-active">
                    <label class="layui-form-label">State</label>
                    <div class="layui-input-inline">
                        <select name="billing_state" lay-filter="billing_state" id="billing_state"
                                lay-verify="required"></select>
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">City</label>
                    <div class="layui-input-inline">
                        <select name="billing_city" id="billing_city" lay-verify="required"> </select>
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">Zip code</label>
                <div class="layui-input-inline">
                    <input type="text" name="billing_zip"  id="billing_zip" lay-verify="zipCode" autocomplete="off" placeholder=""
                           class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">Country or Region</label>
                <div class="layui-input-inline">
                    <select name="billing_region" disabled lay-verify="billing_region">
                        <option value=""></option>
                        <option value="United States" selected="selected">United States</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <div class=" button-wrapper">
                    <button type="submit" class="serial-form-btn" lay-submit="" lay-filter="serial-btn2">Continue
                    </button>
                </div>
            </div>
        </form>
    </div>
</section>

<section class="section" id="maintain-page3">
    <div class="section-content maintain-page3">
        <h4>Here’s your estimated quote:</h4>
        <div class="maintain-bill" style="margin-top: 10px">
            <ul class="quote-list quote-list-top"></ul>
            <ul class="quote-list">
                <li>
                    <span>Shipping</span><span  class="shippingNum">$0.00</span>
                </li>
                <li>
                    <span>Tax</span><span class="taxNum">$0.00</span>
                </li>
            </ul>
            <div class="quote-total">
                <span class="label">Total</span><span class="totalNum">$0.00</span>
            </div>
        </div>
        <ul class="maintain-list">
            <li>You agree to return</li>
            <li>InstantPods will inspect the product you returned and refund the replacement deposit once the inspection
                is completed.
            </li>
            <li>If the product you returned was determined fake, physically damaged, has unauthorized modification, or
                you had never returned the product, the replacement deposit won’t be refunded. We will notify you in
                this case
            </li>
        </ul>
        <div class="maintain-accept">
            <input style="vertical-align: -1px;" type="checkbox" name="" title="" lay-skin="primary" checked>
            <span>I accept and agree to the InstantPods Repair Terms and Conditions.</span>
        </div>
        <div class="maintain-submit">
            <div class="btn" id="repair-btn">Submit Repair</div>
            <p>By submitting this repair, you accept InstantPods’s Terms and Conditions. If you don’t agree with Terms &
                Conditions, find other options.</p>
        </div>
    </div>
</section>

<section class="section" id="maintain-page4">
    <div class="section-content maintain-bill maintain-page4">
        <h3>We will replace your AirPods</h3>
        <p class="desc">We will replace both sides of your AirPods to</p>
        <p>ensure the quality of the repair and best</p>
        <p>customer experience.</p>
        <h5 class="quote">Here’s your estimated quote:</h5>
        <ul class="quote-list quote-list-top"></ul>
        <ul class="quote-list">
            <li>
                <span>Shipping</span><span class="shippingNum">$0.00</span>
            </li>
            <li>
                <span>Tax</span><span class="taxNum">$0.00</span>
            </li>
        </ul>
        <div class="quote-total">
            <span class="label">Total</span><span class="totalNum">$0.00</span>
        </div>
        <p class="quote-lower">We will charge a deposit of the product you are</p>
        <p>replacing so that we can send you the replacement</p>
        <p>first. Once we receive your returned faulty</p>
        <p>product, we will <span class="strong">refund</span> the replacement deposit.</p>
    </div>
</section>

<section class="section" id="maintain-page5">
    <div class="section-content maintain-bill maintain-page5">
        <h3>We will replace your Charging Case</h3>
        <p class="zs">***</p>
        <h5 class="quote">Here’s your estimated quote:</h5>
        <ul class="quote-list quote-list-top"></ul>
        <ul class="quote-list">
            <li>
                <span>Shipping</span><span class="shippingNum">$0.00</span>
            </li>
            <li>
                <span>Tax</span><span class="taxNum">$0.00</span>
            </li>
        </ul>
        <div class="quote-total">
            <span class="label">Total</span><span class="totalNum">$0.00</span>
        </div>
        <p class="quote-lower">We will charge a deposit of the product you are</p>
        <p>replacing so that we can send you the replacement</p>
        <p>first. Once we receive your returned faulty</p>
        <p>product, we will <span class="strong">refund</span> the replacement deposit.</p>
    </div>
</section>
<script src="static/js/jquery.min.js" type="application/javascript"></script>
<script src="static/js/states_city.js" type="application/javascript"></script>
<script src="static/layui/layui.js" type="application/javascript"></script>
<script src="static/js/search.js" type="application/javascript"></script>
<script>
    layui.use(['laydate', 'form'], function () {
        var laydate = layui.laydate;
        var form = layui.form;
        //日期
        laydate.render({
            elem: '#expiration'
        });
        form.verify({
            zipCode: [
                /^\d{6}$/
                ,'zip code Must be 6 digits'
            ]
        });
        var stateArr = [];
        var cityArr = [];
        var stateData = window.stateData;
        for (var key in stateData) {
            stateArr.push(stateData[key])
        }
        $("#state").html("<option value='-'>Please Select</option>");
        $("#billing_state").html("<option value='-'>Please Select</option>");
        for (var i = 0; i < stateArr.length; i++) {
            $("#state").append(new Option(stateArr[i].code, stateArr[i].code));
            $("#billing_state").append(new Option(stateArr[i].code, stateArr[i].code));
            $("#billing_city").html("<option value='-'>Please Select</option>");
            $("#city").html("<option value='-'>Please Select</option>");
        }
        form.render('select');
        form.on('select(state)', function (data) {
            $("#city").html("<option value='-'>Please Select</option>");
            for (var i = 0; i < stateArr.length; i++) {
                if (stateArr[i].code == data.value) {
                    var children = stateArr[i].children;
                    for (var val in children) {
                        cityArr.push(children[val])
                    }
                    for (var j = 0; j < cityArr.length; j++) {
                        $("#city").append(new Option(cityArr[j].code, cityArr[j].code));
                    }
                    form.render('select');
                }
            }
        });
        form.on('select(billing_state)', function (data) {
            $("#billing_city").html("<option value='-'>Please Select</option>");
            for (var i = 0; i < stateArr.length; i++) {
                if (stateArr[i].code == data.value) {
                    var children = stateArr[i].children;
                    for (var val in children) {
                        cityArr.push(children[val])
                    }
                    for (var j = 0; j < cityArr.length; j++) {
                        $("#billing_city").append(new Option(cityArr[j].code, cityArr[j].code));
                    }
                    form.render('select');
                }
            }
        });
        form.on('submit(serial-btn1)', function (data) {
            window.serialData1 = data.field;
            $("#maintain-page1").hide();
            $("#maintain-page2").show();
            return false;
        });
        form.on('checkbox(is_send)', function (data) {
            if(data.elem.checked) {
                $('#billing_street').val(window.serialData1.street_address);
                $('#billing_apt').val(window.serialData1.spt);
                $('#billing_state').val(window.serialData1.state);
                form.render('select');
                $('#billing_zip').val(window.serialData1.zip);
                for (var i = 0; i < stateArr.length; i++) {
                    if (stateArr[i].code == window.serialData1.state) {
                        var children = stateArr[i].children;
                        for (var val in children) {
                            cityArr.push(children[val])
                        }
                        for (var j = 0; j < cityArr.length; j++) {
                            $("#billing_city").append(new Option(cityArr[j].code, cityArr[j].code));
                        }
                        $('#billing_city').val(window.serialData1.city);
                        form.render('select');
                    }
                }
            } else {
                $('#billing_street').val('');
                $('#billing_apt').val('');
                $('#billing_state').val('');
                $('#billing_city').val('');
                $('#billing_zip').val('');
            }
        });
        form.on('submit(serial-btn2)', function (data) {
            window.serialData2 = data.field;
            // layer.msg(JSON.stringify(data.field))
            $("#maintain-page2").hide();
            $("#maintain-page3").show();
            return false;
        });
    });
    $(function () {
        var orderData = JSON.parse(localStorage.getItem("orderData"));
        var userInfo = JSON.parse(localStorage.getItem("info"));
        $('.taxNum').text('$' + orderData.tax);
        $('.shippingNum').text('$' + orderData.shipping);
        $('.totalNum').text('$' + orderData.total);
        let quoteListStr = '';
        let orderArr = orderData.goods;
        for (var i = 0; i< orderArr.length; i++) {
            quoteListStr += '<li>\n' +
                '                <span>' + orderArr[i].name + '</span><span>' + orderArr[i].price + '</span>\n' +
                '            </li>'
        }
        $('.quote-list-top').html(quoteListStr);
        $("#repair-btn").on("click", function () {
            $("#maintain-page3").hide();
            var orderData = {}
            $.extend(orderData, serialData1, serialData2, userInfo);
            $.ajax({
                type: "POST",
                url: "/api/order/create",
                data: JSON.stringify(orderData),
                dataType: "json",
                success: function (data) {
                    layer.msg(data.msg);
                    localStorage.setItem("orderSn", data.order_sn);
                    if (userInfo.position == 'A') {
                        $("#maintain-page4").show();
                    } else {
                        $("#maintain-page5").show();
                    }
                },
                error: function (data) {
                    layer.msg('Submission Failed');
                    if (userInfo.position == 'A') {
                        $("#maintain-page4").show();
                    } else {
                        $("#maintain-page5").show();
                    }
                }
            });

        })
    })

</script>
</body>

</html>
